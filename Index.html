<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>GetKey Menu</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0f1724; /* dark blue */
      --card:#0b1220;
      --muted:#94a3b8;
      --accent:#6ee7b7;
      --glass: rgba(255,255,255,0.03);
      color-scheme: dark;
    }
    *{box-sizing:border-box}
    body{
      margin:0;min-height:100vh;background:linear-gradient(180deg,#071029 0%,#061621 60%);font-family:Inter,system-ui,Arial,sans-serif;color:#e6eef8;display:flex;align-items:center;justify-content:center;padding:6px;
    }
    .wrap{width:100%;max-width:920px}
    header{display:flex;gap:16px;align-items:center;margin-bottom:18px}
    .logo{width:64px;height:64px;border-radius:12px;background:linear-gradient(135deg,var(--accent),#60a5fa);display:flex;align-items:center;justify-content:center;font-weight:700;color:#042024;box-shadow:0 6px 20px rgba(6,12,34,0.6)}
    h1{font-size:20px;margin:0}
    p.lead{margin:0;color:var(--muted);font-size:13px}

    .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:14px;padding:20px;box-shadow:0 8px 30px rgba(2,6,23,0.6);border:1px solid rgba(255,255,255,0.03)}

    .row{display:flex;gap:12px;align-items:center}
    .input-group{display:flex;gap:8px;margin-top:12px}
    input[type="text"]{flex:1;padding:12px 14px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);background:var(--glass);color:inherit;font-size:15px}
    button{padding:10px 14px;border-radius:10px;border:0;background:linear-gradient(90deg,#0ea5a5,#34d399);color:#042024;font-weight:600;cursor:pointer}
    button.ghost{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted)}
    .small{font-size:13px;color:var(--muted)}

    .meta{display:flex;gap:10px;align-items:center;margin-top:12px}
    code.badge{background:rgba(255,255,255,0.03);padding:6px 10px;border-radius:8px;font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, monospace;font-size:13px;color:var(--accent)}

    .preview{margin-top:18px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.005));padding:14px;border-radius:10px;border:1px dashed rgba(255,255,255,0.03)}
    .hint{margin-top:10px;color:var(--muted);font-size:13px}

    .toast{position:fixed;right:20px;bottom:20px;background:#05202a;padding:12px 16px;border-radius:10px;box-shadow:0 8px 30px rgba(2,6,23,0.6);border:1px solid rgba(255,255,255,0.03);display:none}
    .toast.show{display:block}

    @media (max-width:640px){header{gap:10px}.logo{width:95px;height:55px}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo">K</div>
      <div>
        <h1>L·∫•y Key Login üëá </h1>
        <p class="lead">Trang nh·ªè ti·ªán √≠ch ƒë·ªÉ ƒë·ªçc gi√° tr·ªã <code>key</code> trong link, ch·ªânh s·ª≠a v√† sao ch√©p nhanh.</p>
      </div>
    </header>

    <main class="card">
      <div class="row">
        <div style="flex:1">
          <div class="small">Key b√™n d∆∞·ªõi üëá</div>
          <div class="input-group">
            <input id="keyInput" type="text" placeholder="Kh√¥ng c√≥ key" />
            <button id="copyBtn" title="Sao ch√©p">Sao ch√©p</button>
      </div>

      <div class="preview" id="previewArea">
        <div><strong>Copyright ¬© TungAPI.vn</strong></div>
        <div class="hint">B·∫°n c√≥ th·ªÉ copy Key ·ªü tr√™n v√† c√≥ ƒë·ªãnh d·∫°ng nh∆∞ n√†y <code>?key=...</code> d√°n v√†o ph·∫ßn Enter Key c·ªßa menu ƒë·ªÉ ho·∫°t ƒë·ªông Config</div>
      </div>
    </main>

    <div class="toast" id="toast">ƒê√£ sao ch√©p!</div>
  </div>

  <script>
    // Helper: l·∫•y gi√° tr·ªã param t·ª´ query string
    function getParam(name, url) {
      if (!url) url = window.location.href;
      name = name.replace(/[\[\]]/g, "\\$&");
      var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)");
      var results = regex.exec(url);
      if (!results) return null;
      if (!results[2]) return '';
      return decodeURIComponent(results[2].replace(/\+/g, " "));
    }

    const keyInput = document.getElementById('keyInput');
    const copyBtn = document.getElementById('copyBtn');
    const applyBtn = document.getElementById('applyBtn');
    const previewArea = document.getElementById('previewArea');
    const currentUrl = document.getElementById('currentUrl');
    const rawQuery = document.getElementById('rawQuery');
    const status = document.getElementById('status');
    const toast = document.getElementById('toast');

    function showToast(text = 'ƒê√£ sao ch√©p!', ms = 1400){
      toast.textContent = text; toast.classList.add('show');
      setTimeout(()=> toast.classList.remove('show'), ms);
    }

    function updateUI(){
      const k = getParam('key');
      keyInput.value = k === null ? '' : k;
      rawQuery.textContent = window.location.search || '(r·ªóng)';
      currentUrl.textContent = window.location.href;
      status.textContent = k === null ? 'Kh√¥ng t√¨m th·∫•y param key trong URL.' : 'ƒê√£ t√¨m th·∫•y gi√° tr·ªã key.';
    }

    // Khi b·∫•m copy: copy n·ªôi dung input (n·∫øu r·ªóng th√¨ copy to√†n b·ªô URL)
    copyBtn.addEventListener('click', async ()=>{
      const val = keyInput.value.trim();
      try{
        await navigator.clipboard.writeText(val || window.location.href);
        showToast(val ? 'ƒê√£ sao ch√©p key!' : 'ƒê√£ sao ch√©p [ Ch∆∞a c√≥ ]');
      }catch(e){
        // fallback
        const temp = document.createElement('textarea'); temp.value = val || window.location.href; document.body.appendChild(temp); temp.select();
        try{document.execCommand('copy'); showToast('ƒê√£ sao ch√©p (fallback)!');}catch(err){alert('Kh√¥ng th·ªÉ sao ch√©p ‚Äî vui l√≤ng copy th·ªß c√¥ng.');}
        temp.remove();
      }
    });

    // √Åp d·ª•ng: c·∫≠p nh·∫≠t query string (pushState) ho·∫∑c th√™m key n·∫øu ch∆∞a c√≥
    applyBtn.addEventListener('click', ()=>{
      const val = keyInput.value.trim();
      const url = new URL(window.location.href);
      if(val===''){
        url.searchParams.delete('key');
      }else{
        url.searchParams.set('key', val);
      }
      window.history.pushState({}, '', url.toString());
      updateUI();
      showToast('URL ƒë√£ c·∫≠p nh·∫≠t');
    });

    // Khi ng∆∞·ªùi s·ª≠a n·ªôi dung input, ƒë·ªïi tr·∫°ng th√°i nh·ªè
    keyInput.addEventListener('input', ()=>{
      if(keyInput.value.trim() === '') status.textContent = 'B·∫°n ƒëang nh·∫≠p (r·ªóng).';
      else status.textContent = 'B·∫°n ƒëang ch·ªânh s·ª≠a gi√° tr·ªã key.';
    });

    // Khi tr√¨nh duy·ªát quay/ƒëi t·ªõi history, c·∫≠p nh·∫≠t giao di·ªán
    window.addEventListener('popstate', updateUI);

    // Kh·ªüi t·∫°o
    updateUI();

    // T√πy ch·ªçn: n·∫øu user mu·ªën d√°n m·ªôt URL v√†o input ƒë·ªÉ parse ngay
    // Gi√∫p: n·∫øu ng∆∞·ªùi d√πng d√°n 1 link ch·ª©a ?key=... th√¨ n√∫t "Ph√¢n t√≠ch" t·ª± ƒë·ªông
    keyInput.addEventListener('paste', (e)=>{
      setTimeout(()=>{
        const val = keyInput.value.trim();
        if(/^https?:\/\//i.test(val)){
          // N·∫øu d√°n l√† 1 URL, parse key t·ª´ ƒë√≥ v√† hi·ªÉn th·ªã (kh√¥ng thay ƒë·ªïi URL trang)
          const parsed = getParam('key', val);
          if(parsed !== null){ keyInput.value = parsed; status.textContent = 'ƒê√£ ƒë·ªçc key t·ª´ URL v·ª´a d√°n.'; }
          else { status.textContent = 'URL d√°n v√†o kh√¥ng c√≥ param key.'; }
        }
      }, 50);
    });

  </script>
</body>
  </html>
